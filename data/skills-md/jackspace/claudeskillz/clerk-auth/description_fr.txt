Cette compétence fournit des connaissances complètes sur l'intégration de l'authentification Clerk dans les applications React, Next.js et Cloudflare Workers. Il doit être utilisé lors de la configuration de l'authentification des utilisateurs, de la mise en œuvre de routes protégées, de la vérification des jetons JWT, de la création de modèles JWT personnalisés avec des métadonnées utilisateur et des revendications de l'organisation, de la configuration du middleware Clerk, de l'intégration avec les composants shadcn/ui, du test des flux d'authentification ou du dépannage des erreurs d'authentification Clerk.

À utiliser lors de : l'ajout de Clerk aux projets React/Vite, la configuration de Clerk dans Next.js App Router, la mise en œuvre de l'authentification Clerk dans Cloudflare Workers, la configuration de ClerkMiddleware pour la protection des routes, la création de modèles JWT personnalisés avec des codes courts (user.id, user.email, user.public_metadata.role), l'accès aux revendications de session pour RBAC, l'intégration avec Supabase/Grafbase, la vérification des jetons avec @clerk/backend, l'intégration de Clerk avec Hono, en utilisant les composants Clerk shadcn/ui, en écrivant des tests E2E avec Playwright, en générant des jetons de session de test, en utilisant des adresses e-mail et des numéros de téléphone de test, ou en rencontrant des erreurs d'authentification.

Empêche 11 problèmes documentés : erreurs de clé secrète manquante, échecs de migration de clé API, conditions de compétition du cache JWKS, vulnérabilités CSRF dues aux parties autorisées manquantes, erreurs de chemin d'importation après la mise à niveau de Core 2, problèmes de limite de taille JWT, avertissements de version d'API obsolète, erreurs de composant ClerkProvider JSX, confusion de l'aide async auth(), mauvaise configuration des variables d'environnement et erreurs d'en-tête du mode de développement 431 de Vite.

Mots clés : commis, authentification du commis, authentification du commis, @clerk/nextjs, @clerk/backend, @clerk/clerk-react, clerkMiddleware, createRouteMatcher, verifyToken, useUser, useAuth, useClerk, modèle JWT, revendications JWT, codes courts JWT, JWT personnalisé, revendications de session, modèle getToken, user.public_metadata, org_id, org_slug, org_role, CustomJwtSessionClaims, métadonnées sessionClaims, webhook du commis, clé secrète du commis, clé publiable du commis, routes protégées, authentification Cloudflare Workers, authentification Next.js, authentification shadcn/ui, @hono/clerk-auth, "Clé secrète du commis manquante", "ne peut pas être utilisée comme composant JSX", erreur JWKS, parties autorisées, middleware de commis, ClerkProvider, UserButton, SignIn, SignUp, tests de commis, e-mails de test, numéros de téléphone de test, +clerk_test, 424242 OTP, jeton de session, jeton de test, @clerk/testing, tests de dramaturge, tests E2E, mode de test de commis, détection de bot, générer un jeton de session, tester les utilisateurs
