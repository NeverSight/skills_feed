قم بإعادة تصميم كود PyTorch لتحسين قابلية الصيانة وسهولة القراءة والالتزام بأفضل الممارسات. يحدد ويصلح انتهاكات DRY، والوظائف الطويلة، والتداخل العميق، وانتهاكات SRP، وفرص المكونات المعيارية. يطبق أنماط PyTorch 2.x بما في ذلك تحسين torch.compile، والدقة المختلطة التلقائية (AMP)، وتكوين DataLoader المُحسّن، وتصميم nn.Module المعياري، وفحص التدرج، وإدارة ذاكرة CUDA، وتكامل PyTorch Lightning، وفئات مجموعة البيانات المخصصة، وأنماط مصنع النماذج، وتهيئة الوزن، وأنماط التكرار.
