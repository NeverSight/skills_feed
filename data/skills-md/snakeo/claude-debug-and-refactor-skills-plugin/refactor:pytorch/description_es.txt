Refactorice el código PyTorch para mejorar la mantenibilidad, la legibilidad y el cumplimiento de las mejores prácticas. Identifica y corrige infracciones DRY, funciones largas, anidamiento profundo, infracciones de SRP y oportunidades para componentes modulares. Aplica patrones de PyTorch 2.x que incluyen optimización de torch.compile, precisión mixta automática (AMP), configuración optimizada de DataLoader, diseño modular de nn.Module, puntos de control de gradiente, administración de memoria CUDA, integración de PyTorch Lightning, clases de conjuntos de datos personalizados, patrones de fábrica de modelos, inicialización de peso y patrones de reproducibilidad.
