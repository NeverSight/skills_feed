Refactorice el código de Pandas para mejorar la mantenibilidad, la legibilidad y el rendimiento. Identifica y corrige bucles/.iterrows() que deben ser vectorizados, uso excesivo de .apply() donde existen alternativas vectorizadas, patrones de indexación encadenados, uso inplace=True, tipos de letra ineficientes, oportunidades de encadenamiento de métodos faltantes, filtros complejos, operaciones de fusión sin validación y patrones SetWithCopyWarning. Aplica funciones de Pandas 2.0+, incluido el backend de PyArrow, copia en escritura, operaciones vectorizadas, encadenamiento de métodos, .query()/.eval(), tipos de datos optimizados y patrones de canalización.
