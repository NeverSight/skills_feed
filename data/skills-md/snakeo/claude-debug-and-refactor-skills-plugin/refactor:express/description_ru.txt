Выполните рефакторинг кода Express.js/Node.js, чтобы улучшить удобство обслуживания, читабельность и соответствие лучшим практикам. Преобразует ад обратных вызовов, толстые обработчики маршрутов и устаревшие шаблоны в чистый современный код JavaScript/TypeScript. Применяет архитектуру async/await, контроллер-сервис-репозиторий, правильные шаблоны промежуточного программного обеспечения и модули ESM. Выявляет и исправляет антишаблоны, включая блокировку цикла событий, неправильную обработку ошибок, forEach с асинхронными обратными вызовами и утечки памяти.
