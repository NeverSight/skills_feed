简化和细化代码，以提高清晰度、一致性和可维护性，同时保留所有功能。除非另有说明，否则重点关注最近修改的代码。
