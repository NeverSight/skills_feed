---
name: qa-appender
description: |
  智能问答追加器，将对话中的问答内容追加到现有笔记或新建独立卡片。
  采用C+I结构（干货结论+原文上下文），解决"精简后看不懂"与"不精简太啰嗦"的矛盾。
  Triggers: /qa, /ask
---

# 问答追加器 (Q&A Appender)

**角色定位**：知识裁判，判断问答内容的归属，并采用最佳格式进行追加。

## 核心职责

**单一职责**：将对话中的问答内容，以 **C+I 结构** 追加到现有笔记或新建独立卡片。

## 使用场景

触发指令：`/qa` 或 `/ask`

适用场景：
- 对现有文档中的某个点产生了具体疑惑（What/Why/How）
- 通过对话得到了解答
- 需要将问答记录到笔记中

## 核心逻辑：知识分类

我会充当**"知识裁判"**，判断这个问答的归属：

- **依附型（Context Heavy）**：离开原文背景就看不懂 → 追加到原文末尾
- **独立型（Atomic Concept）**：通用概念，可脱离原文理解 → 生成独立卡片

详细分类标准见：`references/classification_guide.md`

## 工作流程

当你输入 `/qa` 或 `/ask` 时，我会：

1. **智能识别会话范围**
   - **自动识别**：分析最近的对话，识别当前讨论的主题和问题边界
   - **关键信号**：
     - 用户提出新问题的时间点
     - 话题转换的标志（如"另外"、"还有个问题"）
     - 问题已解决的标志（如"好的"、"明白了"、"解决了"）
   - **提取原则**：只提取与当前问题相关的连续对话片段，避免包含无关内容
   - **智能判断**：
     - 如果是单个问答（1-3轮）：提取该问答
     - 如果是复杂讨论（4-10轮）：提取完整讨论过程
     - 如果超过10轮：提示用户确认是否包含全部

2. **读取分类标准**
   - 执行前必须先读取 `references/classification_guide.md`
   - 判断问答的归属（依附型 vs 独立型）

3. **确定处理方式**
   - 依附型：在原文末尾追加 `## 💡 实战答疑 (Q&A)` 章节
   - 独立型：生成独立知识卡片

4. **应用C+I结构**
   - 读取 `references/ci_structure.md` 获取完整规范
   - 严格按照模板格式组织内容
   - Logic 在上（干货结论），Context 在下（原文现场）

5. **获取确认**
   - 一次性给出：
     - **会话范围**：明确告知提取了哪几轮对话（如"提取了最近3轮对话"）
     - **判断结果**：依附型或独立型
     - **判断理由**：为什么这样判断
     - **目标文件路径**：将写入哪个文件
   - **禁止显示完整的待追加内容预览**（预览太长，干扰阅读）
   - 只确认一次，等待用户回复

6. **写入文件**
   - 用户确认后，直接写入文件
   - **禁止**再次显示预览或再次确认
   - 写入后简短告知结果即可

## 执行规范（重要）

**智能范围识别**：
- ✅ 自动识别相关对话片段，避免提取无关内容
- ✅ 在确认阶段明确告知提取的会话范围
- ❌ 不要提取整个对话历史

**一次确认原则**：
- ✅ 只在步骤5确认一次
- ❌ 禁止在步骤6再次确认

**无预览原则**：
- ✅ 只显示会话范围、判断结果和简短理由
- ❌ 禁止显示完整的待追加内容预览
- 原因：预览内容过长会干扰阅读，用户信任判断逻辑

**高效执行**：
```
步骤1：智能识别会话范围（内部处理）
步骤2-4：读取+分析+组织内容（内部处理）
步骤5：输出会话范围+判断结果 + 等待确认（一次）
步骤6：直接写入 + 简短告知（完成）
```

## C+I 结构概述

采用 **C+I 结构** 解决"精简后看不懂"与"不精简太啰嗦"的矛盾：

- **C (Context)** - 原文现场：当时的完整对话，包含代码、报错、参数
- **I (Insight)** - 干货结论：一句话通用原理，不带具体案例

完整说明与模板见：`references/ci_structure.md`

## 与其他 skills 的协作

**上游**：
- `conversation-extractor`：生成基础笔记
- `process-doc-generator`：生成过程文档

**下游**：
- 追加后的文档可以继续用 `process-doc-generator` 扩展

## 资源文件

- **C+I结构详解**：[references/ci_structure.md](references/ci_structure.md)
- **分类指南**：[references/classification_guide.md](references/classification_guide.md)
